# 20231123 TIL

## 数据库筛选以 JSON 字段判断

数据库中有些字段信息以 JSON 形式存储在一个字段中，例如将认证相关的信息都存在 auth_info 字段中，如下：
```go
type AuthInfo struct {
	IdNumber string `json:"id_number"`
	Name     string `json:"name"`
	Phone    string `json:"phone"`
}
```

在筛选时要以 auth_info 中的 id_number 值进行判断，查询语句写法如下：

```go
// auth_info 是 json 结构体名称，id_number 是 json 结构字段名
db = db.Where("json_extract(auth_info, '$.id_number') = ?", "xxx")
```