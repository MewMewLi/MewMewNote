# 20231205 TIL

[TOC]



## 01 WSL 教程

使用 WSL2 + Goland 进行 Go 项目开发及测试

## 02 CentOS7 升级 git 版本

[CentOS7 升级 git 版本](https://juejin.cn/post/7071910670056292389)

## 03 CentOS7 Go Proxy 设置

[CentOS7 Go Proxy 设置](https://www.cnblogs.com/linqiaobao/p/14260701.html)

## 04 Goland 项目爆红解决

[Goland 项目爆红解决](https://blog.csdn.net/weixin_44559544/article/details/124668072)

## 05 本地运行项目

```shell
cd /mnt/d/GoProject
cd ../d/
make do_build
make lwh-test-autopanel
make frontend
```

## 06 测试用例编写

```go
package alipan_api

import "testing"

// token
// refres token
func TestAliPan_AuthorizeQrCode(t *testing.T) {
	aliPan := NewAliPan()
	res1, err := aliPan.AuthorizeQrCode()
	// 拿到二维码url

	aliPan.AuthorizeQrCodeImage(res1.Sid)
	// 拿到图片

	go func() {
		for {
			// 检查状态
		}
	}()

	// 打印出accessToken, refresh token

}
```

```go
    authorize_test.go:76: qrCodeAccessToken: &{Bearer eyJraWQiOiJLcU8iLCJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJjZDY4ODUzNzViZTg0MmRhYWM3YjVhODZiNGZiNmYzYSIsImF1ZCI6IjdmM2ZkOTdmNzVlYjRhODk5YmMwYzRlMGMxYmI1NmNhIiwicyI6ImNkYSIsImlzcyI6ImFsaXBhbiIsImV4cCI6MTcwMTc3MjQ2NywiaWF0IjoxNzAxNzY1MjY0LCJqdGkiOiJkZjVlZjlkYmQyNjk0Y2Y0OTFhZTlhZjdiYTYzMWI1NCJ9.doYOTVz9Hr1hDHQeAzAAu9QptQfBLTAxxzurW5W9l-8 eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJjZDY4ODUzNzViZTg0MmRhYWM3YjVhODZiNGZiNmYzYSIsImF1ZCI6IjdmM2ZkOTdmNzVlYjRhODk5YmMwYzRlMGMxYmI1NmNhIiwiZXhwIjoxNzA5NTQxMjY0LCJpYXQiOjE3MDE3NjUyNjQsImp0aSI6IjkyZmE1ZGFiNTcxZDRjZWM4ZThiOWE3YjAzMjZjMzQ5In0.IJQyhr6AyYwksTiV9_cZzU03kYWBHY1bNe9KFXEVoRB5JrxjxcNSO7sN5Qg8SZuYcKE71oeuBEVxGqycY69new 7200}

```

## 获取文件列表

```go
package alipan_api

import "github.com/levigross/grequests"

type ListReq struct {
	DriverID string `json:"driver_id"`
}

type FileItem struct {
	FileID string `json:"file_id"`
}
type ListRes struct {
	Items []FileItem `json:"items"`
}

func (ali *AliPan) AliList() {
	resp, err := grequests.Post("yuming"+"/adrive/v1.0/openFile/list", &grequests.RequestOptions{
		JSON: &ListReq{
			DriverID: "213213213123",
		},
		//Headers: ali.GenHttpHeader(),
	})

	if resp.StatusCode != 200 {
		// log
		return
	}

	res := &ListRes{}
	err = resp.JSON(&res)
	if err != nil {
		// log
		return
	}

}
```

